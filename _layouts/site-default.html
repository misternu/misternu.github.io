<!DOCTYPE html>
<html lang="en">
{% include site-head.html %}
<body>
  <div class="grid-overlay"></div>
  <div class="mountains">
    <div class="mountain-layer"></div>
  </div>

  <main>
    <div class="container">
      {{ content }}
    </div>
  </main>

  {% include site-footer.html %}

<script>
  // Scroll-based reveal effects
  (function() {
    const mountains = document.querySelector('.mountains');
    const mountainLayer = document.querySelector('.mountain-layer');
    const scrollIndicator = document.getElementById('scroll-indicator');
    const contentSections = document.querySelectorAll('.content-section');

    function handleScroll() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const vh = window.innerHeight;
      const scrollThreshold = vh * 0.05; // Start fading after 5% of viewport scroll
      const fadeDistance = vh * 0.15; // Complete fade over 15% of viewport
      const scrollProgress = Math.min(Math.max(scrollTop - scrollThreshold, 0) / fadeDistance, 1);

      // Fade out scroll indicator quickly
      if (scrollIndicator) {
        const indicatorProgress = Math.min(scrollTop / (vh * 0.15), 1);
        scrollIndicator.style.opacity = Math.max(0.6 - indicatorProgress, 0);
      }

      // Gradually dim mountains as we scroll (over ~50% of viewport for smooth transition)
      const mountainDimProgress = Math.min(scrollTop / (vh * 0.5), 1);
      const mountainIntensity = 0.3 - (0.2 * mountainDimProgress); // From 0.3 to 0.1

      if (mountainLayer) {
        mountainLayer.style.setProperty('--mountain-intensity', mountainIntensity);
      }

      // Fade in all content sections based on scroll progress
      contentSections.forEach(section => {
        section.style.opacity = scrollProgress;
      });
    }

    // Smooth scroll on header/indicator click
    function scrollToContent() {
      const firstSection = document.querySelector('.content-section');
      if (firstSection) {
        const offsetTop = firstSection.getBoundingClientRect().top + window.pageYOffset;
        const offset = window.innerHeight * 0.15; // 15% of viewport above content
        window.scrollTo({
          top: offsetTop - offset,
          behavior: 'smooth'
        });
      }
    }

    if (scrollIndicator) {
      scrollIndicator.addEventListener('click', scrollToContent);
    }

    const header = document.querySelector('header');
    if (header) {
      header.style.cursor = 'pointer';
      header.addEventListener('click', scrollToContent);
    }

    // Handle scroll events
    window.addEventListener('scroll', handleScroll);
    handleScroll(); // Initial check

    // Reset scroll on page unload
    window.addEventListener('beforeunload', function() {
      window.scrollTo(0, 0);
    });

    // Email copy to clipboard
    const emailEl = document.querySelector('.email-copy');
    if (emailEl) {
      const originalHTML = emailEl.innerHTML;
      // Get email from text content (after Cloudflare decodes it)
      const email = emailEl.textContent.trim();
      emailEl.addEventListener('click', function() {
        navigator.clipboard.writeText(email).then(() => {
          this.textContent = 'copied to clipboard';
          this.classList.add('copied');
          setTimeout(() => {
            this.innerHTML = originalHTML;
            this.classList.remove('copied');
          }, 2000);
        });
      });
    }
  })();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-81882888-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
